<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jornada da Puberdade Masculina: O HerÃ³i do Conhecimento</title>
    
    <link rel="stylesheet" href="css/styles.css">

</head>
<body>
    
    <div id="splash-screen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #1e3c72, #2a5298); color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10001; transition: opacity 0.5s ease;">
        <h1 style="font-size: 2.5em; margin-bottom: 30px; text-align: center;">Jornada do HerÃ³i do Conhecimento</h1>
        <p style="margin-bottom: 30px; opacity: 0.9;">O Ã¡udio serÃ¡ ativado com o seu clique.</p>
        <button id="start-button" style="padding: 15px 30px; font-size: 1.2em; background: #4CAF50; border: none; color: white; font-weight: bold; border-radius: 10px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.3);">
            ğŸµ Iniciar Jogo e Ligar Som
        </button>
    </div>
    <div class="game-container">
        <div class="sidebar">
            
            <div class="stats">
                <h3>ğŸ† Conquistas do HerÃ³i</h3>
                <div class="stat-item">
                    <span>ğŸ§  Conhecimento (Pts):</span>
                    <span id="knowledge">50</span>
                </div>
                <div class="stat-item">
                    <span>ğŸ… Medalhas Acumuladas:</span>
                    <span id="medals">0</span>
                </div>
            </div>
            
            <div class="stats">
                <h3>ğŸ“š Ganhar Conhecimento</h3>
                <div class="job-option" onclick="doJob('readPubertyBook', 50, 6000, 'ğŸ§ ')">
                    <div class="job-icon">ğŸ“–</div>
                    <div class="job-info">
                        <div class="job-name">Pesquisar/Ler sobre Puberdade</div>
                        <div class="job-reward">+50 Conhecimento, +15 Autoestima (6s)</div>
                    </div>
                </div>
            </div>

            <div class="controls">
                <button class="btn" onclick="resetRoom()">ğŸ”„ RecomeÃ§ar Jornada</button>
            </div>
        </div>

        <div class="main-content" id="main-content">
            <div class="floating-particles">
                <div class="particle">âœ¨</div>
                <div class="particle">ğŸŒŸ</div>
                <div class="particle">ğŸ’«</div>
                <div class="particle">â­</div>
                <div class="particle">ğŸ”®</div>
                <div class="particle">ğŸ’</div>
                <div class="particle">ğŸŒˆ</div>
                <div class="particle">ğŸ¯</div>
            </div>
            
            <div id="character-container">
                <img id="boy-character" src="images/1000006911.png" alt="Garoto Pronta para Aprender" onclick="triggerRandomScenario()"> 
                <div id="thought-bubble">Clique no garoto para aprender!</div>
            </div>
        </div>
    </div>
    
    <div class="message" id="message"></div>

    <div id="question-modal">
        <div id="modal-content">
            <h3 id="modal-scenario-text"></h3>
            <div id="modal-options-container"></div>
        </div>
    </div>

    <button id="mute-button" onclick="toggleMute()">ğŸ”‡</button>

    <audio id="background-music" loop muted volume="0.3">
        <source src="audio/bgm.mp3" type="audio/mpeg">
    </audio>
    <audio id="sfx-click" muted>
        <source src="audio/dice_roll.ogg" type="audio/ogg">
    </audio>
    <audio id="sfx-success" muted>
        <source src="audio/coin.wav" type="audio/wav">
    </audio>
    <audio id="sfx-fail" muted>
        <source src="audio/error.mp3" type="audio/mpeg">
    </audio>
    <audio id="sfx-win" muted>
        <source src="audio/win.wav" type="audio/wav">
    </audio>

    <script>
        // --- VARIÃVEIS DE ESTADO E DADOS ---
        let gameState = {
            health: 70,       
            knowledge: 50,    
            confidence: 60,   
            hygiene: 65,
            medals: 0, 
            activeJobs: new Map()
        };
        
        // ReferÃªncias de Ãudio e DOM
        const bgMusic = document.getElementById('background-music');
        const sfxClick = document.getElementById('sfx-click');
        const sfxSuccess = document.getElementById('sfx-success');
        const sfxFail = document.getElementById('sfx-fail');
        const sfxWin = document.getElementById('sfx-win');
        const muteButton = document.getElementById('mute-button');
        let isMuted = true;

        const boyCharacter = document.getElementById('boy-character');
        const thoughtBubble = document.getElementById('thought-bubble');
        const mainContent = document.getElementById('main-content');

        // Mapeamento das imagens
        const imageMap = {
            NEUTRAL: '1000006911.png', 
            HAPPY: '1000006910.png',   
            SAD: '1000006909.png'      
        };

        // CenÃ¡rios educativos sobre puberdade masculina (DÃºvidas)
        const scenarios = [
            // PERGUNTAS INICIAIS
            {
                text: "Meus pelos estÃ£o crescendo em lugares novos. Isso Ã© normal?",
                options: [
                    { text: "Fico preocupado e tento removÃª-los sem saber como.", effects: { confidence: -10, knowledge: -5 }, sfx: 'fail' },
                    { text: "Entendo que Ã© normal - hormÃ´nios causam crescimento de pelos.", effects: { confidence: +15, knowledge: +20 }, sfx: 'success' }
                ]
            },
            {
                text: "Tenho curiosidade sobre masturbaÃ§Ã£o. Ã‰ normal na adolescÃªncia?",
                options: [
                    { text: "Sinto vergonha e acho que Ã© errado ou doentio.", effects: { confidence: -15, knowledge: -10 }, sfx: 'fail' },
                    { text: "Entendo que Ã© normal e saudÃ¡vel - faz parte do autoconhecimento.", effects: { confidence: +20, knowledge: +25 }, sfx: 'success' }
                ]
            },
            {
                text: "Minha voz estÃ¡ falhando e Ã s vezes fica rouca. Isso Ã© normal?",
                options: [
                    { text: "Fico envergonhado e evito falar alto na escola.", effects: { confidence: -15, knowledge: -5 }, sfx: 'fail' },
                    { text: "Entendo que a laringe estÃ¡ crescendo e Ã© temporÃ¡rio. Aceito a fase.", effects: { confidence: +20, knowledge: +20 }, sfx: 'success' }
                ]
            },
             {
                text: "Meus amigos jÃ¡ estÃ£o mais desenvolvidos que eu. Devo me preocupar?",
                options: [
                    { text: "Me comparo constantemente e fico ansioso e inseguro.", effects: { confidence: -20, health: -5 }, sfx: 'fail' },
                    { text: "Entendo que cada pessoa tem seu prÃ³prio ritmo de desenvolvimento.", effects: { confidence: +25, knowledge: +20 }, sfx: 'success' }
                ]
            },
            // NOVAS PERGUNTAS ADICIONADAS
            {
                text: "Ter 'sonhos molhados' ou acordar com a roupa Ãºmida Ã© normal?",
                options: [
                    { text: "Sim! SÃ£o 'poluiÃ§Ãµes noturnas', o corpo libera excesso de sÃªmen.", effects: { confidence: +25, knowledge: +20 }, sfx: 'success' },
                    { text: "NÃ£o, isso Ã© muito estranho e deve ser um problema hormonal.", effects: { confidence: -15, knowledge: -10 }, sfx: 'fail' }
                ]
            },
            {
                text: "O orgasmo dura sempre o mesmo tempo para todas as pessoas?",
                options: [
                    { text: "NÃ£o! A duraÃ§Ã£o e a intensidade sÃ£o diferentes para cada pessoa e momento.", effects: { confidence: +10, knowledge: +20 }, sfx: 'success' },
                    { text: "Sim, hÃ¡ um tempo mÃ©dio, se for diferente, algo pode estar errado.", effects: { confidence: -5, knowledge: -5 }, sfx: 'fail' }
                ]
            },
            {
                text: "Ter uma ereÃ§Ã£o 'do nada' (sem pensar nisso) Ã© normal?",
                options: [
                    { text: "Sim! Ã‰ comum na puberdade, causado por reflexos nervosos ou hormÃ´nios. Ã‰ um sinal de corpo saudÃ¡vel.", effects: { confidence: +25, knowledge: +25 }, sfx: 'success' },
                    { text: "NÃ£o, Ã© constrangedor e significa que estou tendo pensamentos inadequados.", effects: { confidence: -20, knowledge: -10 }, sfx: 'fail' }
                ]
            },
            {
                text: "O que eu sinto nÃ£o Ã© importante. Devo guardar tudo para mim?",
                options: [
                    { text: "NÃ£o! Compartilhar sentimentos com alguÃ©m de confianÃ§a Ã© fundamental para a saÃºde mental.", effects: { confidence: +30, health: +15 }, sfx: 'success' },
                    { text: "Sim, Ã© melhor ser forte e nÃ£o incomodar os outros com meus problemas.", effects: { confidence: -20, health: -15 }, sfx: 'fail' }
                ]
            },
        ];
        
        // --- FUNÃ‡Ã•ES DE ÃUDIO ---
        function playSound(soundName) {
            if (isMuted) return;
            const sounds = { 'click': sfxClick, 'success': sfxSuccess, 'fail': sfxFail, 'win': sfxWin };
            const sound = sounds[soundName];
            if (sound) {
                sound.currentTime = 0;
                // Adicionado .load() para forÃ§ar o navegador a ler o arquivo antes de tocar
                sound.load(); 
                sound.play().catch(e => console.log('Audio play failed:', e));
            }
        }

        function toggleMute() {
            isMuted = !isMuted;
            bgMusic.muted = isMuted;
            sfxClick.muted = isMuted;
            sfxSuccess.muted = isMuted;
            sfxFail.muted = isMuted;
            sfxWin.muted = isMuted; 
            muteButton.textContent = isMuted ? 'ğŸ”‡' : 'ğŸ”Š';

            if (!isMuted) {
                playMusic();
            } else {
                bgMusic.pause();
                bgMusic.currentTime = 0;
            }
        }
        
        function playMusic() {
            if (isMuted) return;
            bgMusic.load(); 
            bgMusic.play().catch(e => console.log("Autoplay music failed:", e));
        }
        // --- FIM DAS FUNÃ‡Ã•ES DE ÃUDIO ---
        
        // FunÃ§Ã£o para trocar a imagem do avatar
        function setCharacterImage(imageName) {
            boyCharacter.src = `images/${imageName}`; 
        }

        // --- LÃ“GICA DE CENÃRIO E PROGRESSO ---
        
        function updateScenario() {
            // A transiÃ§Ã£o de fundo Ã© tratada no CSS (adicionada no styles.css)
            
            if (gameState.medals >= 6) {
                mainContent.className = 'main-content scenario-3'; 
                showMessage("âœ¨ Seu conhecimento atingiu a clareza mÃ¡xima! Desbloqueou CenÃ¡rio 3!", false);
            } else if (gameState.medals >= 3) {
                mainContent.className = 'main-content scenario-2';
            } else {
                mainContent.className = 'main-content scenario-1'; 
            }
        }

        function updateStats() {
            document.getElementById('knowledge').textContent = Math.round(gameState.knowledge) + ' pts';
            document.getElementById('medals').textContent = gameState.medals; 
            
            updateScenario();
        }

        function giveRewardItem() {
            gameState.medals += 1; 
            applyEffects({ knowledge: 30, confidence: 15 }); 
            
            showMessage('ğŸ‰ PRÃŠMIO! VocÃª ganhou uma Medalha! Seu conhecimento estÃ¡ crescendo.', false);
            playSound('win');
            updateStats();
        }


        // --- LÃ“GICA DE PERGUNTAS E INTERAÃ‡ÃƒO ---
        function triggerRandomScenario() {
            if (document.getElementById('question-modal').style.display === 'flex') {
                showMessage("JÃ¡ temos uma dÃºvida ativa! Responda primeiro.", true);
                playSound('fail');
                return;
            }
            
            const scenario = scenarios[Math.floor(Math.random() * scenarios.length)];
            showQuestionModal(scenario);
            playSound('win'); 
            
            boyCharacter.classList.remove('boy-happy', 'boy-sad');
            boyCharacter.classList.add('boy-sad'); 
            
            thoughtBubble.textContent = "Uau, preciso responder isso!";
        }

        function showQuestionModal(scenario) {
            const modal = document.getElementById('question-modal');
            const text = document.getElementById('modal-scenario-text');
            const container = document.getElementById('modal-options-container');
            
            text.textContent = scenario.text;
            container.innerHTML = '';
            
            scenario.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'modal-option';
                button.textContent = option.text;
                button.onclick = () => selectOption(option, scenario);
                container.appendChild(button);
            });
            
            modal.style.display = 'flex';
        }
        
        function selectOption(option, scenario) {
            applyEffects(option.effects);
            document.getElementById('question-modal').style.display = 'none';
            
            playSound(option.sfx);
            
            const isCorrect = option.sfx === 'success';

            const feedbackText = `${isCorrect ? 'âœ… Resposta Correta!' : 'âŒ BOMBA! Resposta Incorreta.'}`;
            showMessage(feedbackText, !isCorrect); 
            
            // ReaÃ§Ã£o do personagem
            boyCharacter.classList.remove('boy-happy', 'boy-sad'); 
            
            if (isCorrect) {
                setCharacterImage(imageMap.HAPPY);
                boyCharacter.classList.add('boy-happy');
                thoughtBubble.textContent = "Acertei! Me sinto um super-herÃ³i do conhecimento!";
                giveRewardItem(); 
            } else {
                setCharacterImage(imageMap.SAD);
                boyCharacter.classList.add('boy-sad');
                thoughtBubble.textContent = "Que pena, essa dÃºvida me deixou confuso. Preciso estudar mais.";
            }
            
            // Retorna ao estado neutro apÃ³s 3 segundos
            setTimeout(() => {
                boyCharacter.classList.remove('boy-happy', 'boy-sad');
                setCharacterImage(imageMap.NEUTRAL); 
                thoughtBubble.textContent = "Clique no garoto para aprender!";
            }, 3000);
        }

        // --- LÃ“GICA DE GERENCIAMENTO (MANTIDA) ---

        function applyEffects(effects) {
            Object.keys(effects).forEach(stat => {
                if (gameState.hasOwnProperty(stat)) {
                    if (stat !== 'knowledge') {
                        gameState[stat] = Math.max(0, Math.min(100, gameState[stat] + effects[stat]));
                    } else {
                        gameState[stat] = Math.max(0, gameState[stat] + effects[stat]);
                    }
                }
            });
            if (gameState.health <= 0 || gameState.confidence <= 0) {
                 showMessage('Fim de jogo! VocÃª nÃ£o conseguiu gerenciar bem seu desenvolvimento.', true);
                 playSound('fail');
                 setTimeout(() => resetRoom(), 3000);
            }
        }

        function doJob(jobType, reward, duration, emoji) {
            if (gameState.activeJobs.has(jobType)) return;
            gameState.activeJobs.set(jobType, true);
            
            setTimeout(() => {
                applyEffects({ knowledge: reward, confidence: 15 });
                showMessage(`Atividade concluÃ­da! Ganho de ${reward} Conhecimento. ğŸ§ `);
                playSound('success');
                gameState.activeJobs.delete(jobType);
                updateStats();
            }, duration);
        }

        function resetRoom() {
            window.location.reload(); 
        }

        function showMessage(text, isError = false) {
            const message = document.getElementById('message');
            message.textContent = text;
            message.className = 'message' + (isError ? ' error' : '');
            message.classList.add('show');
            
            setTimeout(() => {
                message.classList.remove('show');
            }, 6000);
        }

        // --- FUNÃ‡ÃƒO DE INICIALIZAÃ‡ÃƒO CORRIGIDA ---
        document.addEventListener('DOMContentLoaded', () => {
            const startButton = document.getElementById('start-button');
            
            // ANTES DE TUDO, CONFIGURA O BOTÃƒO PARA INICIAR O JOGO E O ÃUDIO
            startButton.addEventListener('click', () => {
                const splashScreen = document.getElementById('splash-screen');
                splashScreen.style.opacity = '0';
                setTimeout(() => {
                    splashScreen.style.display = 'none';
                    initializeGame(); // INICIA O JOGO APÃ“S O CLIQUE
                }, 500);
            });
            
            // O cÃ³digo abaixo Ã© apenas para configurar o mute button no inÃ­cio, nÃ£o inicia o jogo
            muteButton.textContent = isMuted ? 'ğŸ”‡' : 'ğŸ”Š';
        });

        function initializeGame() {
            // ESTA FUNÃ‡ÃƒO SÃ“ RODA DEPOIS QUE O USUÃRIO CLICOU
            updateStats();
            // Tenta ligar a mÃºsica se nÃ£o estiver no mudo
            if (isMuted === false) { 
                playMusic(); 
            }
            setupCharacterInteraction();
        }
    </script>
</body>
</html>